<!-- Add Task Form -->
<form action="/tasks" method="post">
    <div>
        <label for="patient_id">Patient ID</label>
        <input type="number" id="patient_id" name="patient_id">
    </div>
    <input type="hidden" name="formType" value="addTask"> <!-- This line was added -->
    <div>
        <label for="details">Details</label>
        <input type="text" id="details" name="details">
    </div>
    <button type="submit">Add Task</button>
</form>
<% if (isDoctor) { %>
    <h1>Welcome, Doctor!</h1>
<% } else { %>
    <h1>You are not a doctor.</h1>
    <!-- Other content for non-doctors -->
<% } %>

<h1>Tasks List</h1>

<!-- Submit Tasks Form -->
<form id="submitTasksForm" action="/tasks" method="POST">
    <input type="hidden" name="formType" value="submitTasks"> <!-- This line was added -->

    <ul>
        <%
        for (let i = 0, d = 0; i < tasks.length || d < done_task_nurse_info.length; i++, d++) {
            const task = tasks[i];
            const nurseInfo = done_task_nurse_info[d];
        %>
            <li>
                <input type="checkbox" name="taskIds" value="<%= task.task_id %>">
                <%= task.details %> - <%= task.doctor_name %> - <%= task.added_date.toLocaleString() %> - <%= task.task_id %>
                <% if (nurseInfo) { %>
                    - Nurse: <%= nurseInfo.name %>
                <% } %>

                <!-- delete is not supported in html only get and post -->


            <a class="delete" data-dtask="<%= task.task_id  %>" href="">delete</a>
            </li>
        <% } %>
        
    </ul>
    <button type="submit">Submit</button>
</form>
<script>
    document.querySelectorAll('a.delete').forEach(trashcan => {
  trashcan.addEventListener('click', (e) => {
    e.preventDefault(); // Prevent the default action of the link
    
    const endpoint = `/tasks/${trashcan.dataset.dtask}`;

    fetch(endpoint, {
      method: 'DELETE',
    })
    .then(response => response.json())
    .then(data => window.location.href = data.redirect)
    .catch(err => console.error(err));
  });
});

  </script>
  <script>
    var isDoctor = '<%= isDoctor %>';
    
if (isDoctor) {
    console.log("Welcome, Doctor!");
} else {
    console.log("You are not a doctor.");
}

</script>